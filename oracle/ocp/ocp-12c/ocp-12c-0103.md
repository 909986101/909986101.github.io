# 限定和排序数据

限制 SELECT 语句限制返回的行称为选择（selection）。本章将讨论 WHERE 子句，它是对 SELECT 语句选择功能的增强。ORDER BY 子句是语言的进一步增强，它提供了数据排序功能。和符号（&）替换通过在运行时替代查询元素。

## 限制查询检索的行

### WHERE 子句

WHERE 子句通过提供语言，并依据一种或者多种条件限制返回的行，来扩充 SELECT 语句。

```
SELECT *|{[DISTINCT] column|expression [alias],...}
FROM table
[WHERE condition(s)];
```

WHERE 子句总是紧跟在 FROM 子句之后。方括号表示 WHERE 子句是可选的，可以同时应用一种或者多种条件来限制结果集。通过使用条件运算符来比较两个项，就可以指定条件。这些项可能是列值、字面值或者表达式。等于运算符（equality operator）最常用于限制结果集。

1. 基于数字的条件
   
   ```
   SELECT last_name, salary
   FROM employees
   WHERE salary = 10000;
   
   SELECT last_name, salary
   FROM employees
   WHERE salary = '10000';
   ```

   第二个查询执行隐式数据类型转换

   WHERE 子句允许表达式在比较运算符的任何一边

   ```
   SELECT last_name, salary
   FROM employees
   WHERE salary/10 = department_id*10;
   ```

1. 基于字符的条件
   
   在条件子句奶用单引号将字符字面值引起来，就可以指定依据字符数据去顶选择那些行的条件。

   ```
   SELECT last_name
   FROM employees
   WHERE job_id='SA_ERP';
   ```

   字符字面值数据区分大小写

   `Clause 1: WHERE job_id='SA_ERP'`  
   `Clause 1: WHERE job_id='sa_erp'`

   基于字符的条件并不只限于比较列值和字面值

   ```
   SELECT employee_id, job_id, last_name, first_name
   FROM employees
   WHERE last_name=first_name;
   ```

   基于字符的表达式可以构成由条件运算符划分的条件的一个或者连个部分。通过将字面值连接到一个或者多个字符列，就可以形成字符表达式。

   `Clause 1: WHERE 'A '||last_name||furest_name = 'A King'`

1. 基于日期的条件
   
   日期字面值和字符数据一样都必须包含在单引号内。当在 WHERE 条件自己中使用时，DATE 列会与其他 DATE 列或者日期字面值进行比较。这些字面值会依据默认的日期格式（即 DD-MON-RR）自动转换为日期值。DD 表示日，MON 表示月的前三个字母，RR 表示 Year 2000 —— 顺应年（如果 RR 基于 50 和 99 之间，Oracle 服务器返回上个世纪的日期值，否则返回本世纪的日期值）。也可以指定完整的四位数年份 YYYY。

   ```
   SELECT employee_id
   FROM job_history
   WHERE start_date = end_date;
   
   SELECT employee_id
   FROM job_history
   WHERE start_date = '01-JAN-2001';

   SELECT employee_id
   FROM job_history
   WHERE start_date = '01-JAN-01';

   SELECT employee_id
   FROM job_history
   WHERE start_date = '01-JAN-99';
   ```

   在包含 DATE 值的表达式中也支持使用加减运算符的算术运算。类似 `END_DATE - START_DATE` 的表达式返回数字值，它表示 START_DATE 和 END_DATE 之间的天数。类似 `START_DATE + 1` 的表达式返回 START_DATE 之后 1 天的 DATE 值。

   ```
   SELECT employee_id
   FROM job_history
   WHERE start_date + 1 = '01-JAN-99';
   ```

### 比较运算符

1. 等于和不等于
   
   表3-1 不等于运算符

   |运算符|说明|
   |:-|:-|
   |`<`|小于|
   |`>`|大于|
   |`<=`|小于等于|
   |`>=`|大于等于|
   |`<>`|不等于|
   |`!=`|不等于|

   数字不相等很直观

   `CLause 1: WHERE aslary <= 3000`

   测试字符不相等，不等于运算符两边被比较的字符串被转换为其字符的数字表示。依据数据库字符集和 NLS（National Language Support，国家语言支持）设置，每个字符串的计算使用一个二进制或语言的（linguistic）比较方法来完成。

   ```
   SELECT last_name
   FROM employees
   WHERE last_name < 'King';
   ```

   对日期值的不等于比较与字符数据的比较过程类似。Oracle 服务器将日期保存为内部数字格式，在条件内比较这些值。

   ```
   SELECT last_name, hire_date
   FROM employees
   WHERE hire_date < '01-JAN-2003';
   ```

1. 使用 BETWEEN 运算符的范围比较
   
   BETWEEN 运算符测试列值或者表达式值是否介于两个边界值的范围之内。闭区间。

   ```
   SELECT last_name, salary
   FROM employees
   WHERE salary BETWEEN 3400 AND 4000;
   ```

   用 BETWEEN 运算符指定条件相当于用连个基于不等于的运算符指定条件，使用 BETWEEN 运算符指定范围条件更简洁、更方便。这种对等性说明，不等于运算符用来计算数字、字符和日期操作数的机制同样适用于 BETWEEN 运算符。

   并不限于只将字面值作为操作数指定给 BETWEEN 运算符，操作数号可以是列值和表达式。

   ```
   SELECT first_name, hire_date
   FROM employees
   WEHRE '24-JUL-1994' BETWEEN hire_date+30 AND '07-JUN-1996'
   ```

1. 用 IN 运算符设置比较
   
   IN 运算符测试某项是不是一组字面值的成员。用逗号（,）将字面值分开，并将它们包含在圆括号内，通过这样来指定集合。如果字面值是字符或者日期值，那么就必须使用单引号来界定它们。在集合中可以包含任意多个字面值。

   ```
   SELECT last_name, salary
   FROM employees
   WHERE salary IN (3000, 4000, 5000);
   ```

   字符和日期

   `WHERE last_name IN ('King', 'Ramklass')`  
   `WHERE hire_date IN ('01-JAN-1996', '01-DEC-1999')`

1. 使用 LIKE 运算符的模式比较
   
   